{{define "sidebar"}}
<details
  class="w-full rounded-3xl border border-slate-800/70 bg-[#121417]/80 p-4 shadow-[0_30px_90px_-60px_rgba(0,0,0,0.95)] backdrop-blur md:hidden"
>
  <summary
    class="cursor-pointer list-none text-sm font-semibold text-slate-200"
  >
    Filters
  </summary>
  <div class="mt-4 space-y-6">{{template "sidebar_content" .}}</div>
</details>
<aside
  class="hidden w-72 shrink-0 space-y-6 rounded-3xl border border-slate-800/70 bg-[#121417]/80 p-5 shadow-[0_30px_90px_-60px_rgba(0,0,0,0.95)] backdrop-blur md:block"
>
  {{template "sidebar_content" .}}
</aside>
{{end}} {{define "sidebar_content"}}
<form action="/" method="get">
  <div
    class="flex items-center gap-2 rounded-full border border-slate-700/70 bg-[#111317] px-3 py-2 text-sm text-slate-300 shadow-[inset_0_0_0_1px_rgba(15,23,42,0.6)]"
  >
    <svg
      class="h-4 w-4 text-slate-500"
      viewBox="0 0 20 20"
      fill="none"
      stroke="currentColor"
      stroke-width="1.5"
    >
      <circle cx="9" cy="9" r="6"></circle>
      <path d="M14 14l4 4"></path>
    </svg>
    <input
      class="w-full bg-transparent text-sm text-slate-200 placeholder:text-slate-500 focus:outline-none"
      type="search"
      name="s"
      placeholder="Search memos..."
      value="{{.SearchQuery}}"
    />
    <svg
      class="h-4 w-4 text-slate-600"
      viewBox="0 0 20 20"
      fill="none"
      stroke="currentColor"
      stroke-width="1.5"
    >
      <path d="M6 6h8M8 10h4M9 14h2"></path>
    </svg>
  </div>
  {{if .TagQuery}}<input type="hidden" name="t" value="{{.TagQuery}}">{{end}}
  {{if .FolderQuery}}<input type="hidden" name="f" value="{{.FolderQuery}}">{{end}}
  {{if .DateQuery}}<input type="hidden" name="d" value="{{.DateQuery}}">{{end}}
</form>

<div>
  <div
    class="flex items-center justify-between text-xs uppercase tracking-[0.3em] text-slate-500"
  >
    <span>{{.CalendarMonth.Label}}</span>
    <span class="flex items-center gap-2 text-slate-600">
      <span class="rounded-full border border-slate-700 px-2 py-0.5">&lt;</span>
      <span class="rounded-full border border-slate-700 px-2 py-0.5">&gt;</span>
    </span>
  </div>
  <div
    class="mt-3 grid grid-cols-7 gap-1 text-[10px] uppercase tracking-[0.2em] text-slate-600"
  >
    <span class="text-center">Sun</span>
    <span class="text-center">Mon</span>
    <span class="text-center">Tue</span>
    <span class="text-center">Wed</span>
    <span class="text-center">Thu</span>
    <span class="text-center">Fri</span>
    <span class="text-center">Sat</span>
  </div>
  <div class="mt-2 grid grid-cols-7 gap-1 text-xs">
    {{range .CalendarMonth.Weeks}}
      {{range .Days}}
        {{if .HasUpdates}}
          <a
            class="flex h-7 w-7 items-center justify-center rounded-md transition {{if .Active}}ring-1 ring-sky-400/70 bg-[#2a2f35] text-slate-100{{else}}bg-[#2a2f35] text-slate-100 hover:bg-[#3a4149]{{end}}"
            href="{{.URL}}"
            title="{{.UpdateCount}} updates"
          >
            {{.Day}}
          </a>
        {{else}}
          <div class="flex h-7 w-7 items-center justify-center rounded-md transition {{if .InMonth}}text-slate-300 hover:bg-[#1c2026]{{else}}text-slate-600{{end}}">
            {{.Day}}
          </div>
        {{end}}
      {{end}}
    {{end}}
  </div>
</div>

<div>
  <div
    class="flex items-center justify-between text-xs uppercase tracking-[0.25em] text-slate-500"
  >
    <span>Tags</span>
    <span class="text-slate-600">.</span>
  </div>
  <div class="mt-3 flex flex-wrap gap-2 text-xs">
    {{range .TagLinks}} {{if .Disabled}}
    <span
      class="rounded-full border border-slate-800/70 bg-[#15181c]/60 px-2.5 py-1 text-slate-600"
      >{{if or (eq .Name "TODO") (eq .Name
      "DUE")}}{{.Name}}{{else}}#{{.Name}}{{end}} ({{.Count}})</span
    >
    {{else}}
    <a
      class="rounded-full border px-2.5 py-1 transition {{if .Active}}border-sky-500 bg-sky-500/20 text-sky-200{{else}}border-slate-700/70 bg-[#15181c] text-slate-300 hover:border-slate-500{{end}}"
      href="{{.URL}}"
      >{{if or (eq .Name "TODO") (eq .Name
      "DUE")}}{{.Name}}{{else}}#{{.Name}}{{end}} ({{.Count}})</a
    >
    {{end}} {{else}}
    <span class="text-slate-500">No tags yet.</span>
    {{end}}
  </div>
</div>

<div>
  <div
    class="flex items-center justify-between text-xs uppercase tracking-[0.25em] text-slate-500"
  >
    <span>Folders</span>
    <span class="text-slate-600">.</span>
  </div>
  <div class="mt-3 text-xs">
    {{template "folder_tree" .FolderTree}}
  </div>
</div>
{{end}}

{{define "folder_tree"}}
{{if .}}
<ul class="list-disc space-y-1 pl-4 text-slate-300">
  {{template "folder_tree_nodes" .}}
</ul>
{{else}}
<span class="text-slate-500">No folders yet.</span>
{{end}}
{{end}}

{{define "folder_tree_nodes"}}
{{range .}}
<li>
  {{if .URL}}
    <a class="{{if .Active}}text-sky-200{{end}}" href="{{.URL}}">{{.Name}}</a>
  {{else}}
    <span>{{.Name}}</span>
  {{end}}
  {{if .Children}}
    <ul class="list-disc space-y-1 pl-4">
      {{template "folder_tree_nodes" .Children}}
    </ul>
  {{end}}
</li>
{{end}}
{{end}}

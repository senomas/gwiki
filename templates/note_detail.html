{{define "note_detail"}}
<div class="space-y-3">
  {{if .NotePath}}
    <h1 class="text-2xl font-semibold text-slate-100">
      {{if .NoteURL}}
        <a class="text-sky-300 hover:text-sky-200" href="{{.NoteURL}}">{{.NoteTitle}}</a>
      {{else}}
        <a class="text-sky-300 hover:text-sky-200" href="/notes/{{.NotePath}}">{{.NoteTitle}}</a>
      {{end}}
    </h1>
  {{else}}
    <h1 class="text-2xl font-semibold text-slate-100">{{.NoteTitle}}</h1>
  {{end}}
  {{if .NoteMeta.Has}}
    <details class="group">
      <summary class="list-none cursor-pointer select-none text-xs text-slate-500">
        <span class="group-open:hidden">
          <span class="mr-2">{{if .NoteMeta.Folder}}{{.NoteMeta.Folder}}{{else}}/{{end}}</span>
          {{if .NoteMeta.Updated.IsZero}}
            {{if .NoteMeta.UpdatedRaw}}{{.NoteMeta.UpdatedRaw}}{{else}}Metadata{{end}}
          {{else}}
            {{.NoteMeta.Updated.Format "02/01/2006 15:04:05"}}
          {{end}}
        </span>
        <span class="hidden group-open:inline">Metadata</span>
      </summary>
      <div class="mt-2 grid gap-x-6 gap-y-1 text-xs text-slate-500 sm:grid-cols-[max-content,1fr]">
        <span class="uppercase tracking-[0.18em] text-slate-600">Folder</span><span>{{if .NoteMeta.Folder}}{{.NoteMeta.Folder}}{{else}}/{{end}}</span>
        {{if .NoteMeta.Updated.IsZero}}{{else}}<span class="uppercase tracking-[0.18em] text-slate-600">Updated</span><span>{{.NoteMeta.Updated.Format "02/01/2006 15:04:05"}}</span>{{end}}
        {{if .NoteMeta.Created.IsZero}}{{else}}<span class="uppercase tracking-[0.18em] text-slate-600">Created</span><span>{{.NoteMeta.Created.Format "02/01/2006 15:04:05"}}</span>{{end}}
        {{if .NoteMeta.UpdatedRaw}}<span class="uppercase tracking-[0.18em] text-slate-600">Updated</span><span>{{.NoteMeta.UpdatedRaw}}</span>{{end}}
        {{if .NoteMeta.CreatedRaw}}<span class="uppercase tracking-[0.18em] text-slate-600">Created</span><span>{{.NoteMeta.CreatedRaw}}</span>{{end}}
        {{if .NoteMeta.Priority}}<span class="uppercase tracking-[0.18em] text-slate-600">Priority</span><span>{{.NoteMeta.Priority}}</span>{{end}}
        {{if .NoteMeta.Visibility}}<span class="uppercase tracking-[0.18em] text-slate-600">Visibility</span><span>{{.NoteMeta.Visibility}}</span>{{end}}
        {{if .NoteMeta.ID}}<span class="uppercase tracking-[0.18em] text-slate-600">ID</span><span>{{.NoteMeta.ID}}</span>{{end}}
        {{if gt .NoteMeta.HistoryCount 0}}
          <span class="uppercase tracking-[0.18em] text-slate-600">History</span>
          <div class="space-y-1">
            {{range .NoteMeta.History}}
              <div>
                {{if .At.IsZero}}{{else}}<span>{{.At.Format "02/01/2006 15:04:05"}}</span>{{end}}
                {{if .Action}}<span class="ml-2">Â· {{.Action}}</span>{{end}}
                {{if .User}}<span class="ml-2 text-slate-600">({{.User}})</span>{{end}}
              </div>
            {{end}}
          </div>
        {{end}}
      </div>
    </details>
  {{end}}
  <div class="note-body text-sm leading-relaxed text-slate-200">
    {{if .RenderedHTML}}{{.RenderedHTML}}{{else}}{{template "note_content" .}}{{end}}
  </div>
</div>
{{end}}
